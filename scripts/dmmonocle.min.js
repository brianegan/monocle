/*
 *	dmMonocle 1.0
 *	by Brian Egan
 *	
 *	Copyright (c) 2009 Board of Regents of the Nevada System of Higher Education, on behalf, of the University of Nevada, Las Vegas
 *	Licensed under MIT License 
 *  http://code.google.com/p/dmmonocle/wiki/License
 */

function dmMonocle(H,n,N,m){var K=0,h=$("#dmMonocle").width(),v=$("#dmMonocle").height(),G="",AB=H,s=n,A=N,g=m,P,d,k=120,w=120,u,E,p,R,Q,q,l=false,T=[],z=[],AA=[],a=[],C=0,AG,AF,f,AH,U,AC,Z,V,S,AK,AJ=h/AB,j=v/s,F,M;if(AJ>=j){F=j;minZoomLevel=j}else{F=AJ;minZoomLevel=AJ}function O(AQ,AN,AM,AL){if($("#dmMonocleMenu").length>0){}else{Y(AQ,AN)}$("#dmMonocle div").remove();$("#dmThumbnail div").remove();$("#dmMainImage div").remove();$("#dmThumbnail").remove();$("#dmMainImageContainer").remove();$("#dmMainImage").remove();clearTimeout(q);if(l===true){$('<div id="dmThumbnail"></div>').appendTo("#dmMonocle").css("top",((w+10)*-1)+"px")}else{$('<div id="dmThumbnail" style="left:0; top:0"></div>').appendTo("#dmMonocle")}$('<div id="dmMainImageContainer"></div>').appendTo("#dmMonocle");$('<div id="dmMainImage"></div>').appendTo("#dmMainImageContainer");if(AN===0){bigImageWidth=AB;bigImageHeight=s}else{if(AN===90){bigImageWidth=s;bigImageHeight=AB}else{if(AN===180){bigImageWidth=AB;bigImageHeight=s}else{if(AN===270){bigImageWidth=s;bigImageHeight=AB}}}}dmWidth=AB*AQ;dmHeight=s*AQ;imageWidth=bigImageWidth*AQ;imageHeight=bigImageHeight*AQ;imageOffsetX=imageWidth*AM-(h/2);imageOffsetY=imageHeight*AL-(v/2);if(imageOffsetX<0){imageOffsetX=0}else{if(imageOffsetX+h>imageWidth){imageOffsetX=imageWidth-h}}if(imageOffsetY<0){imageOffsetY=0}else{if(imageOffsetY+v>imageHeight){imageOffsetY=imageHeight-v}}if(imageHeight>imageWidth){var AP=w/(imageHeight/AQ);d=AP*(imageHeight/AQ);P=AP*(imageWidth/AQ)}else{if(imageHeight<imageWidth){AP=k/(imageWidth/AQ);d=AP*(imageHeight/AQ);P=AP*(imageWidth/AQ)}else{if(imageHeight==imageWidth){AP=w/(imageHeight/AQ);d=AP*(imageHeight/AQ);P=AP*(imageWidth/AQ)}}}var AS=AP*100;var AR=new Image();var AO=G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+AS+"&DMWIDTH="+k+"&DMHEIGHT="+w+"&DMROTATE="+AN;if(imageWidth<=h&&imageHeight<=v){$(AR).load(function(){$("#dmThumbnail").append(this);P=$(this).width();d=$(this).height();$("#dmThumbnail").width(P).height(d);mainImageBG="url("+G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+(AQ*100)+"&DMWIDTH="+dmWidth+"&DMHEIGHT="+dmHeight+"&DMROTATE="+AN+")";$("#dmMainImage").width(h).height(v);$("#dmMainImageContainer").width(h).height(imageHeight);$("#dmMainImage").css("position","relative").css("margin","0 auto").css("background-image",mainImageBG).css("background-position","center center").css("background-repeat","no-repeat").addClass("dmNoDrag");$('<div class="dmNavigator"></div>').appendTo("#dmThumbnail").width(P).height(d).css("z-index","20").addClass("dmNoDrag");J()}).attr("class","thumbImage").attr("src",AO)}else{if(imageWidth<=h&&imageHeight>=v){$(AR).load(function(){$("#dmThumbnail").append(this);P=$(this).width();d=$(this).height();$("#dmThumbnail").width(P).height(d);var AV='<div class="dmClickNavLayer" style="width:'+P+"px; height:"+d+'px;"></div>';$(AV).appendTo("#dmThumbnail");mainImageBG="url("+G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+(AQ*100)+"&DMWIDTH="+dmWidth+"&DMHEIGHT="+dmHeight+"&DMROTATE="+AN+")";$("#dmMainImage").width(h).height(imageHeight);var AY=($("#dmMainImage").width()+$("#dmMainImage").width()-h)+"px";var AX=($("#dmMainImage").height()+$("#dmMainImage").height()-v)+"px";var AU="-"+($("#dmMainImage").width()-h)+"px";var AT="-"+($("#dmMainImage").height()-v)+"px";var AZ=($("#dmMainImage").width()-h)+"px";var AW=($("#dmMainImage").height()-v-imageOffsetY)+"px";Z=(h-h);V=(imageHeight-v);S=$("#dmThumbnail img").width()/$("#dmMainImage").width();AK=$("#dmThumbnail img").height()/$("#dmMainImage").height();$("#dmMainImageContainer").css("position","absolute").css("width",AY).css("height",AX).css("left",AU).css("top",AT);$("#dmMainImage").css("position","absolute").css("left",AZ).css("top",AW).css("background-image",mainImageBG).css("background-position","center top").css("background-repeat","no-repeat").toggleClass("dmHover").bind("dragstart",function(){$(this).toggleClass("dmDragging")}).bind("drag",function(Aa){e(Aa)}).bind("dragend",function(){$(this).toggleClass("dmDragging");J()}).bind("dblclick",function(Ab){var Aa=0;var Ac=0;if(!Ab){var Ab=window.event}if(Ab.pageX||Ab.pageY){Aa=Ab.pageX;Ac=Ab.pageY}else{if(Ab.clientX||Ab.clientY){Aa=Ab.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;Ac=Ab.clientY+document.body.scrollTop+document.documentElement.scrollTop}}b(Aa,Ac)});o(AM,AL)}).attr("class","thumbImage").attr("src",AO)}else{if(imageWidth>=h&&imageHeight<=v){$(AR).load(function(){$("#dmThumbnail").append(this);P=$(this).width();d=$(this).height();$("#dmThumbnail").width(P).height(d);var AV='<div class="dmClickNavLayer" style="width:'+P+"px; height:"+d+'px;"></div>';$(AV).appendTo("#dmThumbnail");mainImageBG="url("+G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+(AQ*100)+"&DMWIDTH="+dmWidth+"&DMHEIGHT="+dmHeight+"&DMROTATE="+AN+")";$("#dmMainImage").width(imageWidth).height(v);U=($("#dmMainImage").width()+$("#dmMainImage").width()-h)+"px";AC=($("#dmMainImage").height()+$("#dmMainImage").height()-v)+"px";S=$("#dmThumbnail img").width()/$("#dmMainImage").width();AK=$("#dmThumbnail img").height()/$("#dmMainImage").height();var AU="-"+($("#dmMainImage").width()-h)+"px";var AT="-"+($("#dmMainImage").height()-v)+"px";var AX=($("#dmMainImage").width()-h-imageOffsetX)+"px";var AW=($("#dmMainImage").height()-v)+"px";Z=(imageWidth-h);V=(v-v);$("#dmMainImageContainer").css("position","absolute").css("width",U).css("height",AC).css("left",AU).css("top",AT);$("#dmMainImage").css("position","absolute").css("left",AX).css("top",AW).css("background-image",mainImageBG).css("background-position","left center").css("background-repeat","no-repeat").bind("dragstart",function(){$(this).toggleClass("dmDragging")}).bind("drag",function(AY){e(AY)}).bind("dragend",function(){$(this).toggleClass("dmDragging");J()}).bind("dblclick",function(AZ){var AY=0;var Aa=0;if(!AZ){var AZ=window.event}if(AZ.pageX||AZ.pageY){AY=AZ.pageX;Aa=AZ.pageY}else{if(AZ.clientX||AZ.clientY){AY=AZ.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;Aa=AZ.clientY+document.body.scrollTop+document.documentElement.scrollTop}}b(AY,Aa)});o(AM,AL)}).attr("class","thumbImage").attr("src",AO)}else{if(imageWidth<2000||imageHeight<2000){u=400;E=400}else{if(imageWidth>=2000&&imageWidth<3000||imageHeight>=2000&&imageHeight<3000){u=400;E=400}else{if(imageWidth>=3000&&imageWidth<4000||imageHeight>=3000&&imageHeight<4000){u=500;E=500}else{if(imageWidth>=4000&&imageWidth<5000||imageHeight>=4000&&imageHeight<5000){u=500;E=500}else{if(imageWidth>=5000&&imageWidth<6000||imageHeight>=5000&&imageHeight<6000){u=600;E=600}else{if(imageWidth>=6000&&imageWidth<7000||imageHeight>=6000&&imageHeight<7000){u=700;E=700}else{if(imageWidth>=7000&&imageWidth<8000||imageHeight>=7000&&imageHeight<8000){u=800;E=800}else{if(imageWidth>=8000||imageHeight>=8000){u=800;E=800}}}}}}}}$("#dmMainImage").width(imageWidth).height(imageHeight).css("background-color","#EEE").css("position","absolute").css("background-image","none");$(AR).load(function(){$("#dmThumbnail").append(this);P=$(this).width();d=$(this).height();$("#dmThumbnail").width(P).height(d);var Au='<div class="dmClickNavLayer" style="width:'+P+"px; height:"+d+'px;"></div>';$(Au).appendTo("#dmThumbnail");var AY=imageWidth/u;var Ae=imageHeight/E;var Av=Math.ceil(AY);var Am=Math.ceil(Ae);var Ac=P/imageWidth;var AT=d/imageHeight;if(AN===0){for(y=0;y<Am;y++){for(x=0;x<Av;x++){var Ad=u*x;var Aa=E*y;var Ak=Ad*Ac;var Aj=Aa*AT;var Ao=AY.toString().split(".");var AZ="."+Ao[1];var Ab=AZ*Ac;var Ar=Ae.toString().split(".");var Al="."+Ar[1];var At=Al*AT;if((Av-1)-x===0){bigTileOutputWidth=Math.floor(u*AZ);smallTileOutputWidth=bigTileOutputWidth*Ac}else{bigTileOutputWidth=u;smallTileOutputWidth=bigTileOutputWidth*Ac}if((Am-1)-y===0){bigTileOutputHeight=Math.floor(E*Al);smallTileOutputHeight=bigTileOutputHeight*AT}else{bigTileOutputHeight=E;smallTileOutputHeight=bigTileOutputHeight*AT}x2=Ad+bigTileOutputWidth;y2=Aa+bigTileOutputHeight;var An=AQ*100;var As='<div class="tile-'+C+'" style="position: absolute; : 5; width: '+bigTileOutputWidth+"px; height: "+bigTileOutputHeight+"px; left: "+Ad+"px; top: "+Aa+'px; font-family: Arial; "></div>';$(As).appendTo("#dmMainImage");var AX='<div class="'+C+'" style="position: absolute; : 5; width: '+smallTileOutputWidth+"px; height: "+smallTileOutputHeight+"px; left: "+Ak+"px; top: "+Aj+'px; font-family: Arial; "></div>';$(AX).appendTo("#dmThumbnail").addClass("collision");T[C]=G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+An+"&DMWIDTH="+(u+1)+"&DMHEIGHT="+(E+1)+"&DMROTATE="+AN+"&DMX="+Ad+"&DMY="+Aa+"&DMCROP="+Ad+","+Aa+","+x2+","+y2;z[C]=G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+An+"&DMWIDTH="+u+"&DMHEIGHT="+E+"&DMROTATE="+AN+"&DMX="+Ad+"&DMY="+Aa+"&DMCROP="+Ad+","+Aa+","+x2+","+y2;AA[C]=bigTileOutputWidth;a[C]=bigTileOutputHeight;C++}}}else{if(AN==90){for(x=0;x<Av;x++){for(y=Am-1;y>=0;y--){Ao=AY.toString().split(".");AZ="."+Ao[1];Ab=AZ*Ac;Ar=Ae.toString().split(".");Al="."+Ar[1];At=Al*AT;if((Av-1)-x===0){bigTileOutputWidth=Math.floor(u*AZ);bigImageOutputWidth=Math.floor(u*AZ);smallTileOutputWidth=bigTileOutputWidth*Ac}else{bigTileOutputWidth=u;bigImageOutputWidth=u;smallTileOutputWidth=bigTileOutputWidth*Ac}if((Am-1)-y==(Am-1)){bigTileOutputHeight=Math.floor(E*Al);bigImageOutputHeight=Math.floor(E*Al);smallTileOutputHeight=bigTileOutputHeight*AT;Aa=E*y}else{bigTileOutputHeight=E;bigImageOutputHeight=E;smallTileOutputHeight=bigTileOutputHeight*AT;var AW=Math.floor(E*Al);Aa=(E*y)-(E-AW)}Ad=u*x;var Aq=u*-(y-(Am-1));var Ap=E*x;Ak=Ad*Ac;Aj=Aa*AT;x2=Aq+bigImageOutputHeight;y2=Ap+bigImageOutputWidth;An=AQ*100;As='<div class="tile-'+C+'" style="position: absolute; : 5; width: '+bigTileOutputWidth+"px; height: "+bigTileOutputHeight+"px; left: "+Ad+"px; top: "+Aa+'px; font-family: Arial; "></div>';$(As).appendTo("#dmMainImage");AX='<div class="'+C+'" style="position: absolute; : 5; width: '+smallTileOutputWidth+"px; height: "+smallTileOutputHeight+"px; left: "+Ak+"px; top: "+Aj+'px; font-family: Arial; "></div>';$(AX).appendTo("#dmThumbnail").addClass("collision");T[C]=G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+An+"&DMWIDTH="+u+"&DMHEIGHT="+E+"&DMROTATE="+AN+"&DMX="+Aq+"&DMY="+Ap+"&DMCROP="+Aq+","+Ap+","+x2+","+y2;AA[C]=bigTileOutputWidth;a[C]=bigTileOutputHeight;C++}}}else{if(AN==180){for(y=Am-1;y>=0;y--){for(x=Av-1;x>=0;x--){Ao=AY.toString().split(".");AZ="."+Ao[1];Ab=AZ*Ac;Ar=Ae.toString().split(".");Al="."+Ar[1];At=Al*AT;if((Av-1)-x==(Av-1)){bigTileOutputWidth=Math.floor(u*AZ);bigImageOutputWidth=Math.floor(u*AZ);smallTileOutputWidth=bigTileOutputWidth*Ac;Ad=u*x}else{bigTileOutputWidth=u;bigImageOutputWidth=u;smallTileOutputWidth=bigTileOutputWidth*Ac;var Ah=Math.floor(u*AZ);Ad=(u*x)-(u-Ah)}if((Am-1)-y==(Am-1)){bigTileOutputHeight=Math.floor(E*Al);bigImageOutputHeight=Math.floor(E*Al);smallTileOutputHeight=bigTileOutputHeight*AT;Aa=E*y}else{bigTileOutputHeight=E;bigImageOutputHeight=E;smallTileOutputHeight=bigTileOutputHeight*AT;var Af=Math.floor(E*Al);Aa=(E*y)-(E-Af)}Aq=u*-(x-(Av-1));Ap=E*-(y-(Am-1));Ak=Ad*Ac;Aj=Aa*AT;x2=Aq+bigImageOutputWidth;y2=Ap+bigImageOutputHeight;An=AQ*100;As='<div class="tile-'+C+'" style="position: absolute; : 5; width: '+bigTileOutputWidth+"px; height: "+bigTileOutputHeight+"px; left: "+Ad+"px; top: "+Aa+'px; font-family: Arial; "></div>';$(As).appendTo("#dmMainImage");AX='<div class="'+C+'" style="position: absolute; : 5; width: '+smallTileOutputWidth+"px; height: "+smallTileOutputHeight+"px; left: "+Ak+"px; top: "+Aj+'px; font-family: Arial; "></div>';$(AX).appendTo("#dmThumbnail").addClass("collision");T[C]=G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+An+"&DMWIDTH="+u+"&DMHEIGHT="+E+"&DMROTATE="+AN+"&DMX="+Aq+"&DMY="+Ap+"&DMCROP="+Aq+","+Ap+","+x2+","+y2;z[C]=G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+An+"&DMWIDTH="+u+"&DMHEIGHT="+E+"&DMROTATE="+AN+"&DMX="+Aq+"&DMY="+Ap+"&DMCROP="+Aq+","+Ap+","+x2+","+y2;AA[C]=bigTileOutputWidth;a[C]=bigTileOutputHeight;C++}}}else{if(AN==270){for(x=Av-1;x>=0;x--){for(y=0;y<Am;y++){Ao=AY.toString().split(".");AZ="."+Ao[1];Ab=AZ*Ac;Ar=Ae.toString().split(".");Al="."+Ar[1];At=Al*AT;if((Av-1)-x==(Av-1)){bigTileOutputWidth=Math.floor(u*AZ);bigImageOutputWidth=Math.floor(u*AZ);smallTileOutputWidth=bigTileOutputWidth*Ac;Ad=u*x}else{bigTileOutputWidth=u;bigImageOutputWidth=u;smallTileOutputWidth=bigTileOutputWidth*Ac;Ah=Math.floor(u*AZ);Ad=(u*x)-(u-Ah)}if((Am-1)-y===0){bigTileOutputHeight=Math.floor(E*Al);bigImageOutputHeight=Math.floor(E*Al);smallTileOutputHeight=bigTileOutputHeight*AT}else{bigTileOutputHeight=E;bigImageOutputHeight=E;smallTileOutputHeight=bigTileOutputHeight*AT}Aa=E*y;Aq=u*y;Ap=E*-(x-(Av-1));Ak=Ad*Ac;Aj=Aa*AT;x2=Aq+bigImageOutputHeight;y2=Ap+bigImageOutputWidth;An=AQ*100;As='<div class="tile-'+C+'" style="position: absolute; : 5; width: '+bigTileOutputWidth+"px; height: "+bigTileOutputHeight+"px; left: "+Ad+"px; top: "+Aa+'px; font-family: Arial; "></div>';$(As).appendTo("#dmMainImage");AX='<div class="'+C+'" style="position: absolute; : 5; width: '+smallTileOutputWidth+"px; height: "+smallTileOutputHeight+"px; left: "+Ak+"px; top: "+Aj+'px; font-family: Arial; "></div>';$(AX).appendTo("#dmThumbnail").addClass("collision");T[C]=G+"/cgi-bin/getimage.exe?CISOROOT="+g+"&CISOPTR="+A+"&DMSCALE="+An+"&DMWIDTH="+u+"&DMHEIGHT="+E+"&DMROTATE="+AN+"&DMX="+Aq+"&DMY="+Ap+"&DMCROP="+Aq+","+Ap+","+x2+","+y2;AA[C]=bigTileOutputWidth;a[C]=bigTileOutputHeight;C++}}}}}}U=parseInt(((imageWidth)+(imageWidth)-h),10)+"px";AC=($("#dmMainImage").height()+$("#dmMainImage").height()-v)+"px";var AV="-"+($("#dmMainImage").width()-h)+"px";var AU="-"+($("#dmMainImage").height()-v)+"px";var Ai=($("#dmMainImage").width()-h-imageOffsetX)+"px";var Ag=($("#dmMainImage").height()-v-imageOffsetY)+"px";$("#dmMainImageContainer").css("position","absolute").css("width",U).css("height",AC).css("left",AV).css("top",AU);Z=(imageWidth-h);V=(imageHeight-v);AG=$("#dmMainImageContainer").offset().left;AF=$("#dmMainImageContainer").offset().top;f=$("#dmMainImage").width();AH=$("#dmMainImage").height();S=$("#dmThumbnail img").width()/$("#dmMainImage").width();AK=$("#dmThumbnail img").height()/$("#dmMainImage").height();$("#dmMainImage").css("position","absolute").css("left",Ai).css("top",Ag).bind("dragstart",function(){$(this).toggleClass("dmDragging")}).bind("drag",function(Aw){e(Aw)}).bind("dragend",function(){$(this).toggleClass("dmDragging");J()}).bind("dblclick",function(Ax){var Aw=0;var Ay=0;if(!Ax){var Ax=window.event}if(Ax.pageX||Ax.pageY){Aw=Ax.pageX;Ay=Ax.pageY}else{if(Ax.clientX||Ax.clientY){Aw=Ax.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;Ay=Ax.clientY+document.body.scrollTop+document.documentElement.scrollTop}}b(Aw,Ay)});o(AM,AL)}).attr("class","thumbImage").attr("src",AO)}}}}function o(AM,AL){var AN=(($("#dmThumbnail img").width()/$("#dmMainImage").width())*h);var AO=(($("#dmThumbnail img").height()/$("#dmMainImage").height())*v);if(AN>$("#dmThumbnail img").width()){AN=$("#dmThumbnail img").width()}if(AO>$("#dmThumbnail img").height()){AO=$("#dmThumbnail img").height()}navOffsetX=(AM*$("#dmThumbnail img").width())-(AN/2);navOffsetY=(AL*$("#dmThumbnail img").height())-(AO/2);if(navOffsetX<0){navOffsetX=0}else{if((navOffsetX+AN)>$("#dmThumbnail img").width()){navOffsetX=$("#dmThumbnail img").width()-AN}}if(navOffsetY<0){navOffsetY=0}else{if((navOffsetY+AO)>$("#dmThumbnail img").height()){navOffsetY=$("#dmThumbnail img").height()-AO}}$("#dmThumbnail .dmClickNavLayer").bind("click",function(AQ){var AP=0;var AR=0;if(!AQ){var AQ=window.event}if(AQ.pageX||AQ.pageY){AP=AQ.pageX;AR=AQ.pageY}else{if(AQ.clientX||AQ.clientY){AP=AQ.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;AR=AQ.clientY+document.body.scrollTop+document.documentElement.scrollTop}}I(AP,AR)});$('<div class="dmNavigator"></div>').appendTo("#dmThumbnail").width(AN).height(AO).css("z-index","20").css("left",navOffsetX+"px").css("top",navOffsetY+"px").bind("dragstart",function(){$(this).toggleClass("dmDragging")}).bind("drag",function(AP){t(AP)}).bind("dragend",function(){$(this).toggleClass("dmDragging");J()});q=setTimeout(function(){J()},750)}function Y(AP,AO){$('<div id="dmMonocleMenu"></div>').insertBefore("#dmMonocle");var AL="<div id='dmMonocleHideNavigator' title='Show/Hide Navigator'>Hide Navigator</div>";$(AL).appendTo("#dmMonocleMenu").bind("click",function(){r()});var AU="<div id='dmMonocleFitWindow' title='Fit Image to Viewer'>Fit Document to Viewer</div>";$(AU).appendTo("#dmMonocleMenu").bind("click",function(){B()});var AQ="<div id='dmMonocleFitWidth' title='Fit Image to Viewer Width'>Fit Image to Viewer Width</div>";$(AQ).appendTo("#dmMonocleMenu").bind("click",function(){AE()});var AR="<div id='dmMonocleMaxRes' title='Maximum Resolution'>Maximum Resolution</div>";$(AR).appendTo("#dmMonocleMenu").bind("click",function(){D()});var AS="<div id='dmMonocleRotateCounterclockwise' title='Rotate Counterclockwise'>Rotate Counterclockwise</div>";$(AS).appendTo("#dmMonocleMenu").bind("click",function(){AI()});var AW="<div id='dmMonocleRotateClockwise' title='Rotate Clockwise'>Rotate Clockwise</div>";$(AW).appendTo("#dmMonocleMenu").bind("click",function(){W()});var AT="<div id='dmMonocleZoomOut' title='Zoom Out'>Zoom Out</div>";$(AT).appendTo("#dmMonocleMenu").bind("click",function(){c()});var AN="<div id='dmZoomLevelGague' title='Zoom Level'>&nbsp;</div>";$(AN).appendTo("#dmMonocleMenu").slider({animate:true,max:100,min:(minZoomLevel*100),change:function(AX,AY){i()}});var AV="<div id='dmMonocleZoomIn' title='Zoom In'>Zoom In</div>";$(AV).appendTo("#dmMonocleMenu").bind("click",function(){X()});if($("#dmObjectSearch").width()>0){$("#dmObjectSearch").appendTo("#dmMonocleMenu")}var AM="<div class='clear'>&nbsp;</div>";$(AM).appendTo("#dmMonocleMenu")}function J(){var AO=parseFloat($(".dmNavigator").css("top"));var AN=AO+$(".dmNavigator").height();var AM=parseFloat($(".dmNavigator").css("left"));var AL=AM+$(".dmNavigator").width();$(".collision").each(function(){var AT=parseFloat($(this).css("top"));var AU=AT+$(this).height();var AW=parseFloat($(this).css("left"));var AR=AW+$(this).width();if(((AO>=AT&&AO<=AU)||(AN>=AT&&AN<=AU)||(AO<AT&&AN>AU))&&((AM>=AW&&AM<=AR)||(AL>=AW&&AL<=AR)||(AM<AW&&AL>AR))){var AP=$(this).attr("class").toString().split(" ");var AV=AP[0];var AS="#dmMainImageContainer .tile-"+AV;$(this).removeClass("collision");$(AS).toggleClass("dmImgTileLoading");var AQ=new Image();$(AQ).load(function(){$(AS).append(this);$(AS).toggleClass("dmImgTileLoading");if(($(this).width()<AA[AV]&&$(this).width()>10)||($(this).height()<a[AV]&&$(this).height()>10)){$(this).width(AA[AV]);$(this).height(a[AV])}}).attr("class","tileimage").attr("src",T[AV]).error(function(){var AX=new Image();$(AX).load(function(){$(AS).append(this);$(AS).toggleClass("dmImgTileLoading");if(($(this).width()<AA[AV]&&$(this).width()>10)||($(this).height()<a[AV]&&$(this).height()>10)){$(this).width(AA[AV]);$(this).height(a[AV])}}).attr("class","tileimage").attr("src",z[AV])})}})}function L(AO,AT,AP,AM,AR,AL){var AN=$("#dmMainImage").position().left;var AU=$("#dmMainImage").position().top;$("#feedback").html(AN);var AS=-1*((AN-AP)*(AR/AO));var AQ=-1*((AU-AM)*(AL/AT));$("div.dmNavigator").css("left",AS).css("top",AQ)}function e(AM){var AN=$("div#dmMainImageContainer");var AU=$(AN).offset().left;var AT=$(AN).offset().top;var Aa=$(AN).width();var Ab=$(AN).height();var AV=$("div#dmMainImage");var AQ=$(AV).width();var AZ=$(AV).height();tempX=(AM.offsetX)-AU;tempY=(AM.offsetY)-AT;var AY=tempX+AQ;var AW=tempY+AZ;var AO=Aa-AQ;var AL=Ab-AZ;if(tempX<0){tempX=0}else{if(AY>Aa){tempX=AO}}if(tempY<0){tempY=0}else{if(AW>Ab){tempY=AL}}$(AV).css({left:tempX,top:tempY});var AR=($("#dmMainImage").width()-h);var AP=($("#dmMainImage").height()-v);var AX=-1*((tempX-Z)*S);var AS=-1*((tempY-V)*AK);$("div.dmNavigator").css("left",AX).css("top",AS)}function b(AR,AO){var AP=$("#dmMonocle").width();var AT=$("#dmMonocle").height();var AV=parseFloat($("#dmMainImage").css("left"));var AS=parseFloat($("#dmMainImage").css("top"));if((AR-$("#dmMonocle").offset().left)>(AP/2)){var AM=(AV+AP/2)-(AR-$("#dmMonocle").offset().left);if(AM<0){AM=0}}else{if((AR-$("#dmMonocle").offset().left)<(AP/2)){AM=AV+(AP/2-(AR-$("#dmMonocle").offset().left));if(AM>$("#dmMainImage").width()-AP){AM=$("#dmMainImage").width()-AP}}else{if((AR-$("#dmMonocle").offset().left)==(AP/2)){AM=AV}}}if((AO-$("#dmMonocle").offset().top)>(AT/2)){var AW=(AS+AT/2)-(AO-$("#dmMonocle").offset().top);if(AW<0){AW=0}}else{if((AO-$("#dmMonocle").offset().top)<(AT/2)){AW=AS+(AT/2-(AO-$("#dmMonocle").offset().top));if(AW>$("#dmMainImage").height()-AT){AW=$("#dmMainImage").height()-AT}}else{if((AO-$("#dmMonocle").offset().top)==(AT/2)){AW=AS}}}var AN=($("#dmMainImage").width()-AP);var AL=($("#dmMainImage").height()-AT);var AU=-1*((AM-AN)*($("#dmThumbnail img").width()/$("#dmMainImage").width()));var AQ=-1*((AW-AL)*($("#dmThumbnail img").height()/$("#dmMainImage").height()));$("#dmMainImage").animate({top:AW,left:AM},"normal","swing");$("div.dmNavigator").animate({top:AQ,left:AU},"normal","swing",function(){J()})}function t(AY){var AV=$("div#dmThumbnail img");var AM=$(AV).offset().left;var AL=$(AV).offset().top;var AT=$(AV).width();var AW=$(AV).height();var AQ=$("div.dmNavigator");var AX=$(AQ).width();var Aa=$(AQ).height();tempX=(AY.offsetX)-AM;tempY=(AY.offsetY)-AL;var AP=tempX+AX;var AN=tempY+Aa;var Ad=AT-AX;var Ac=AW-Aa;if(tempX<0){tempX=0}else{if(AP>AT){tempX=Ad}}if(tempY<0){tempY=0}else{if(AN>AW){tempY=Ac}}$(AQ).css({left:tempX,top:tempY});var AU=($(".dmNavigator").offset().left-$("#dmThumbnail").offset().left);var AZ=($(".dmNavigator").offset().top-$("#dmThumbnail").offset().top);var AS=($("#dmMainImage").width()-h);var AR=($("#dmMainImage").height()-v);var Ab=AS+-1*(($("#dmMainImage").width()/$("#dmThumbnail img").width())*AU);var AO=AR+-1*(($("#dmMainImage").height()/$("#dmThumbnail img").height())*AZ);$("#dmMainImage").css("left",Ab).css("top",AO)}function I(AR,AO){var AU=$("div.dmNavigator").width();var AP=$("div.dmNavigator").height();var AQ=(AO-$("#dmThumbnail").offset().top)-(AP/2);var AS=(AR-$("#dmThumbnail").offset().left)-(AU/2);if((AQ+AP)>$("#dmThumbnail img").height()){AQ=$("#dmThumbnail img").height()-AP}else{if(AQ<0){AQ=0}}if((AS+AU)>$("#dmThumbnail img").width()){AS=$("#dmThumbnail img").width()-AU}else{if(AS<0){AS=0}}var AN=($("#dmMainImage").width()-h);var AM=($("#dmMainImage").height()-v);var AL=AN+-1*(($("#dmMainImage").width()/$("#dmThumbnail img").width())*AS);var AT=AM+-1*(($("#dmMainImage").height()/$("#dmThumbnail img").height())*AQ);$("#dmMainImage").animate({top:AT,left:AL},"normal","swing");$("div.dmNavigator").animate({top:AQ,left:AS},"normal","swing",function(){J()})}function AD(AV,AL,AQ){if(AQ+0.1>1){var AT=1}else{AT=Math.round((AQ+0.1)*100)/100;F=AT}var AP=$("#dmMonocle").width();var AU=$("#dmMonocle").height();var AR=$("#dmMainImage").width()-AP;var AO=$("#dmMainImage").height()-AU;var AY=parseFloat($("#dmMainImage").css("left"));var AS=parseFloat($("#dmMainImage").css("top"));var Aa=$("#dmMainImage").width()/AQ;var AW=$("#dmMainImage").height()/AQ;var AZ=((AR-AY)+(AV-$("#dmMonocle").offset().left))/(Aa*AQ);var AX=((AO-AS)+(AL-$("#dmMonocle").offset().top))/(AW*AQ);var AN=(s*AT*AZ);var AM=(AB*AT*AX);O(AT,K,AZ,AX)}function X(){if(F+0.05<1){F=Math.round((F+0.05)*100)/100;var AO=parseFloat($(".dmNavigator").css("left"));var AM=parseFloat($(".dmNavigator").css("top"));var AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();var AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();$("#dmZoomLevelGague").slider("option","value",(F*100));O(F,K,AN,AL)}else{if(F+0.1>=1){if(F==1){F=1}else{F=1;AO=parseFloat($(".dmNavigator").css("left"));AM=parseFloat($(".dmNavigator").css("top"));AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();$("#dmZoomLevelGague").slider("option","value",(F*100));O(F,K,AN,AL)}}}}function c(){if(F-0.05>minZoomLevel){F=Math.round((F-0.05)*100)/100;var AO=parseFloat($(".dmNavigator").css("left"));var AM=parseFloat($(".dmNavigator").css("top"));var AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();var AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();$("#dmZoomLevelGague").slider("option","value",(F*100));O(F,K,AN,AL)}else{if(F-0.05<=minZoomLevel){if(F==minZoomLevel){F=minZoomLevel}else{F=minZoomLevel;AO=parseFloat($(".dmNavigator").css("left"));AM=parseFloat($(".dmNavigator").css("top"));AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();$("#dmZoomLevelGague").slider("option","value",(F*100));O(F,K,AN,AL)}}}}function i(){F=$("#dmZoomLevelGague").slider("option","value")/100;var AO=parseFloat($(".dmNavigator").css("left"));var AM=parseFloat($(".dmNavigator").css("top"));var AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();var AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();O(F,K,AN,AL)}function D(){F=1;var AO=parseFloat($(".dmNavigator").css("left"));var AM=parseFloat($(".dmNavigator").css("top"));var AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();var AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();$("#dmZoomLevelGague").slider("option","value",(F*100));O(F,K,AN,AL)}function B(){switch(K){case 0:var AQ=h/AB;var AP=v/s;break;case 90:AQ=h/s;AP=v/AB;break;case 180:AQ=h/AB;AP=v/s;break;case 270:AQ=h/s;AP=v/AB;break}if(AQ>=AP){F=AP}else{F=AQ}var AO=parseFloat($(".dmNavigator").css("left"));var AM=parseFloat($(".dmNavigator").css("top"));var AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();var AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();$("#dmZoomLevelGague").slider("option","value",(F*100));O(F,K,AN,AL)}function AE(){switch(K){case 0:F=h/AB;break;case 90:F=h/s;break;case 180:F=h/AB;break;case 270:F=h/s;break}var AO=parseFloat($(".dmNavigator").css("left"));var AM=parseFloat($(".dmNavigator").css("top"));var AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();var AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();$("#dmZoomLevelGague").slider("option","value",(F*100));O(F,K,AN,AL)}function AI(){switch(K){case 0:K=90;break;case 90:K=180;break;case 180:K=270;break;case 270:K=0;break}var AO=parseFloat($(".dmNavigator").css("left"));var AM=parseFloat($(".dmNavigator").css("top"));var AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();var AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();O(F,K,AN,AL)}function W(){switch(K){case 0:K=270;break;case 90:K=0;break;case 180:K=90;break;case 270:K=180;break}var AO=parseFloat($(".dmNavigator").css("left"));var AM=parseFloat($(".dmNavigator").css("top"));var AN=(AO+($(".dmNavigator").width()/2))/$("#dmThumbnail").width();var AL=(AM+($(".dmNavigator").height()/2))/$("#dmThumbnail").height();O(F,K,AN,AL)}function r(){thumbDivTempWidth=(P+10)*-1;thumbDivTempHeight=(d+10)*-1;if(l===true){l=false;$("#dmThumbnail").animate({top:0,left:0},200).animate({top:-30,left:0},200).animate({top:0,left:0},200)}else{l=true;$("#dmThumbnail").animate({top:-60,left:0},200).animate({top:0,left:0},200).animate({top:thumbDivTempHeight,left:0},200)}}O(F,K,0,0)};